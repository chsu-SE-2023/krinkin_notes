**Криптография** - наука о методах обеспечения конфиденциальности и аутентичность информации.

**Криптоанализ** - наука о методах расшифровки зашифрованной информации без преднамеренного для расшифровки ключа

**Ключ** - секретный блок данных, используемый криптографическим алгоритмом при шифровании, дешифровании, постановке и проверке цифровой подписи, вычислении кода аутентификации.

90% криптографии держится на понятии ключ. Задачи делятся на задачи с ключом и тайнопись (стеганография) (без ключа), но вторую обычно под криптографией даже не подразумевают, т.к. криптография ищет надёржный алгоритм кодирования (что наука), когда как тайнопись просто прячет информацию (что ремесло).

Все шифры, используемые сегодня, делятся на поточные и блочные.
**Поточный шифр** - идёт поток бит, на него накладывается шифрующая последовательность. 
**Блочные шифры** - весь шифруемый текст делится на отдельные блоки и результат шифрования каждого блока зависит, как от ключа, так и от содержимого предыдущих блоков.

Шифры могут также быть **перестановочными** (сдигают значение) или **подстановочными** (заменяют значения).
Существуют два способа использования ключа: **симметричный** - берёт один и тот же ключ для шифрования и дешифрования, **ассиметричный** - кодируется открытым ключом и закрытым ключом.
#### Шифр Цезаря

Самый первый постановочный шифр. Буквы сдвигаются по алфавиту на какое-то значение.
#### Квадрат Полибия

Постановочный шифр, в котором буквы заменяются на их индекс в таблице алфавита (A - 1 1, B - 1 2). Очень удобен при передаче сообщений дискретными сигналами.
#### Решетка Кардано

Сообщение расположено в квадрате, а в другом в квадрате прорезаны окна для проявления нужных символов. Решетку можно поворачивать для получения нового сообщения.

![[photo_2025-05-16 00.17.01.jpeg]]
#### Таблица Виженера

Первая таблица с напрямую появившемся ключом. Из сообщения и ключа получается закодированное сообщение.

![[photo_2025-05-16 00.16.25.jpeg]]

Текст: `olegbezdolgov`
Ключ: `ignatignatignat`
Код:    `wrrgu...`
#### Шифр Вернама

Шифр, изобретённый телеграфистом Вернамом в начале XX века. Двоичные текст и ключ складываются по XOR. На обратной стороне по такому же ключу можно восстановить исходное сообщение всё тем же XOR. Если ключ будет размером с текст, то текст нельзя будет восстановить, не имея бесконечного кол-ва времени. %%Энтропия.%%

Текст: `100111101`
Ключ:  `011101011`
Код:     `111010110`
#### Шифры гаммирования

Похож на шифр Вернама. Ключ называется гаммой, но гамма - случайна. Гамма по XOR накладывается на сообщение.
Уязвимость: По кусочку исходного текста можно воссоздать гамму, а следовательно и весь текст целиком.
Шифр используется для кодирования потоковой информации (аудио, видео). Практически такие потоки тяжело воссоздать.
#### Операции преобразования криптоалгоритмов

![[photo_2025-05-16 00.18.37.jpeg]]

$V$ может быть:
1. Некоторая константа
2. Материал ключа
3. Независимая часть шифруемого блока

При всех этих операциях за исключением, быть может, табличной подстановки размер исходного блока равен размеру блока после операции. 
#### Подтабличная подстановка

Пример: размер блока - 3 бита
Блок - 101

Тремя битами можно записать 8 разных бит:
111 010 100 010 110 001 110 101
Меняем блок и элемент по его индексу - 101 на 001.
///
#### Cимметричные алгоритмы шифрования

#### Ассимметричные алгоритмы шифрования

Если злоумышленник завладеет станцией пользователя с ключами, 

Идея: создаётся не один ключ, а два - открытый ключ (известен всем), закрытый ключ (известен лишь одному). Зашифровать можно открытым ключом, а расшифровать можно только зная закрытый ключ. 

##### Шифр RSA (Rivest, Shamir, Adelman)

Генерация ключей:
1. Выбираются два больших простых числа $p$ и $q$.
2. $n = p * q$
3. Выбирается произвольное $e$ такое, что наибольший общий делитель $e$, $p-1$, $q-1$ равен 1
4. Решается уравнение $e*d \% (p-1)(q-1) = 1$
5. Пара (e, n) - открытый ключ
6. d - закрытый ключ

Шифрование:
1. Вычисляется $k = log_{2}n$
2. Весь текст разбивается на блоки по $k$ бит, каждый такой блок m - целое число из отрезка $[0, 2^k-1]$.
3. c = $(m^e) \% n$ - зашифрованный блок

Дешифрование:
1. $m = (c^d) \% n$ - расшифрованный блок

Пример:
$p = 5$, $q = 11$
$N = 55$
$НОД(e, 4, 10) = 1$
$e = 3$
$3d \% 40 = 1$
$d = 27$ - закрытый ключ
$(e, n)$ - $(3, 55)$ - открытый ключ

$k = 5$
$m = 18$

$c = 18^3 \% 55 = 2$

$m = 2^27 \% n = 18$

#### Криптосистемы

Криптосистемы решают следующие проблемы: 

**Каким ключом шифровать?**
- мастер ключом
- ключом сеанса - генерируется из случайных чисел, шифруется мастер ключом

**Шифрованные блоки могут повторятся**
Данные делятся не на блоки, а на цепочку блоков, чтобы каждый блок в цепочке отличался.

**Транспортное кодирование**
Для кодирования сообщения в нужном формате данные делятся по 6 бит и полученным значением берём индекс из некоторого массива символов. После чего на приёме символы преобразуются в изначальные байты.


