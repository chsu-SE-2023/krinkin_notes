Мы знаем, что за бизнес, в каком формате, какого типа данные - мы смогли их извлечь. Для того, чтобы построить модель, мы должны подготовить данные. Здесь нас интересует качество данных, их описание, связи.

#### Восстановление пропущенных значений
- Исключить объекты с пропусками
- Заменить пропущенное значение константой
- Предсказать пропущенное значение на основании других переменных
- Заменить пропущенное значение средним или медианой значение по всему столбику
- Моделировать пропущенное значение с помощью регрессии или с помощью вероятностных функций или другими способами
- Использовать методы взвешивания
В таблице могут быть незаполненные ячейки, или же содержимое некоторых ячеек заведомо некорректное и противоречит здравому смыслу

| ФИО       | Пол | Рост | Вес | Место на олимпиаде |
| --------- | --- | ---- | --- | ------------------ |
| Иванов    | 1   | 172  | 107 | 3                  |
| Петренко  | ?   | 185  | 64  | -4                 |
| Сидорова  | 0   | 168  | 665 | 2                  |
| Николаева | 0   | ?    | 85  | 1                  |
  
Что можно сделать:
- Удалить объект (строку)
- Удалить столбец, если в нем очень много пропусков
- Заменить значение в ячейке на среднее/медиану/моду/... из значений столбца. Например, для столбца-признака (0, 1, 2, 4, 4, 5, ?) пропущенное значение можно заменить на среднее (2,67), медиану (3), моду (4)
  
Что делать с номинальными признаками:  
Если признак "пол человека" (0, 0, 0, 1, 1, ?), то мы можем:
- Заменить на моду (т. е. на 0)
- Сгенерировать 0 с вероятностью $3/5$ или 1 с вероятностью $2/5$
- Волевым решением объявить "пол" числовым признаком (со всеми вытекающими отсюда последствиями), и применить к нему методы восстановления для числовых признаков
#### Восстановление данных при помощи метрики
1. $ρ(P, P) = 0$ (в принципе, логично)
2. $ρ(P, Q)=ρ(Q, P)$ (разумно)
3. $ρ(P, Q)≤ρ(P, T)+ρ(T,Q)$ (неравенство треугольника)
  
==Метрика== может быть вычислена для объектов произвольной природы. Формул существует много, можно придумать свою, главное - она должна отвечать требованиям.
==Известные метрики==:  
Если даны 2 набора $P=(p_1, p_2, ..., p_n)$ и $Q(q_1,q_2,...,q_n)$, то расстояние между $P$ и $Q$ может быть найдено следующими способами:
1. Как в учебнике геометрии (евклидова метрика) - $ρ(P,Q)=\sqrt{(p_1-q_1)^2+(p_2-q_2)^2+...+(p_n-q_n)^2}$
2. Метрика Манхеттен - $ρ(P,Q)=|p_1-q_1|+|p_2-q_2|+...+|p_n-q_n|$
3. Max-метрика $ρ(P,Q)=max(|p_1-q_1|, |p_2-q_2|, ..., |p_n-q_n|)$
  
Метрик очень много, можно придумать свои собственные.  
==Пример== восстановления пропущенных значений:  
![](Excalidraw/07_01.%20Восстановление%20пропущенных%20значений.png)  
![](Excalidraw/07_02.%20Восстановление%20пропущенных%20значений.png)  
![](Excalidraw/07_03.%20Восстановление%20пропущенных%20значений.png)  
Формула для восстановления данных с помощью метрики:  
$$P(A)=\frac{1}{Σ^n_{i=1}\frac{1}{ρ(A,A_j)}}(Σ^n_{j=1}\frac{P(A_j)}{ρ(A,A_j)})$$
Для адекватной работы необходимо, чтобы все признаки (значения по осям) имели одинаковый масштаб.  
==Замечание об использовании метрики==: некоторые признаки фактически будут проигнорированы. В следующем примере различия в росте и различия в весе имеют ОЧЕНЬ разную ценность - это из-за разных единиц измерения:

| Студент  | Вес, кг | Рост, м |
| -------- | ------- | ------- |
| Иванов   | 61      | 1,76    |
| Сидорова | 56      | 1,50    |
| Петров   | 100     | 1,98    |
  
При вычислении метрики все признаки нужно приводить к единой шкале (нормировать):
1. Выполнить преобразование: $p_i'=\frac{p_i-\overline{p}}{s}$. После этого у признака $P$ среднее значение и отклонение будут равны 0 и 1 соответственно
2. К признакам можно предварительно применять разные функции (например, логарифм)
##### Восстановление данных с помощью других столбцов
Используется коэффициент корреляции: признак с большим (по модулю) коэффициентом имеет большее влияние на величину пропущенного признака.
##### Восстановление данных с помощью моделей предсказания
Если мы сумеем научить предсказывать значение признака $P$, используя для этого все другие признаки, то автоматически будет решена проблема восстановления данных для признака $P$.

#### Обогащение данных

==Обогащение данных== - это процесс насыщения данных новой информацией, которая позволяет сделать их более ценными и значимыми с точки зрения той или иной аналитической задачи (например, данные о доходах сотрудников дополнить средними значениями по региону, профессии).  
==Внешнее обогащение== предполагает привлечение дополнительной информации из внешних источников (статистические сайты, сайт мирового банка, правительственные сайты).  
==Внутреннее обогащение== предполагает повышение информативности и значимости данных за счет изменения и реорганизации (были $s$ и $h$, добавили объем $v$).  

#### Преобразование (трансформация) данных
Комплекс методов и алгоритмов, направленных на оптимизацию представления и форматов данных с точки зрения решаемых задач и целей анализа.  
Цель трансформации данных - представить информацию в таком виде, чтобы она могла быть использована более эффективно.  
==Кластерный анализ== - это отдельный вид анализа, который делит объекты на группы по сходным значениям переменных. В рамках сходства они могут быть несравнимы (например, миллиметры, копейки и т. д.)

#### Методы преобразования данных
- Преобразование упорядоченных данных
- Квантование (новые интервалы, на их основе кодирование)
- Сортировка
- Слияние
- Группировка и разгруппировка
- Настройка набора данных
- Табличная подстановка значений
	- Преобразование в уникальные числовые коды
	- Двоичное кодирование
	- Кодирование с помощью дополнительной информации
- Вычисляемые (производные) значения
- Нормализация
#### Квантование

==Квантование== - процедура преобразования данных, состоящая из 2 шагов:
1. Диапазон значений переменной разбивается на заданное число интервалов, каждому из которых присваивается некоторый номер (уровень квантования)
2. Каждое значение заменяется номером интервала квантования
  
==Равномерное (однородное) квантование== - преобразование, при котором диапазон значений разбивается на интервалы равной длины. Имеет смысл, если значения распределены равномерно по всему диапазону значений.  
==Неравномерное (однородное) квантование== - преобразование, при котором диапазон значений разбивается на интервалы различной длины (ассиметричые). Имеет смысл, если в значениях нет пропусков и сгустков.

#### Нормализация

В случае машинного обучения, ==нормализация== - это процедура предобработки входной информации (выборок и реальных данных), при которой значения признаков во входном векторе приводятся к некоторому заданному диапазону, например, $[0...1]$ или $[-1...1]$.  
Необходимость нормализации выборок данных обусловлена природой используемых алгоритмов и моделей Machine Learning. Исходные значения признаков могут изменяться в очень большом диапазоне и отличаться друг от друга на несколько порядков. Это делает работу алгоритмов некорректной.
==Примеры== нормализации:
- Десятичное преобразование
- Максиминное преобразование
- Нормализация с помощью стандартного преобразования
- Нормализация с помощью поэлементных преобразований
#### Описание данных
Частотная гистограмма показывает, сколько раз в переменной встретилось то или иное значение.  
Может быть сделана по любым исходным данным.  
По ней мы можем понять, можно ли использовать классические статистики.  
Если наша частотная гистограмма показывает, что данные слишком несимметрично распределены, то средние могут быть либо завышены, либо занижены.  
Мультимодальные распределения: по факту это смесь распределений и для того, чтобы анализировать переменную, ее требуется разделить на группы, которые и определяют эти пики.
##### Статистика
==Цель описательной статистики== - обработка эмпирических данных, их систематизация, наглядное представление в виде графиков и таблиц, а также их количественное описание посредством основных статистических показателей.

#### Выбросы

==Выброс== - это экстремальные (аномально маленькие или аномально большие) значения входных данных, которые находятся далеко за пределами других наблюдений. Например, все предметы на кухне имеют температуру около 22-25°С, а духовка - 220°С.  
![](Excalidraw/07_04.%20Выброс%20на%20ящике%20с%20усами.png)  
##### Виды выбросов
- На основе размерности изучаемого массива данных
	- Одномерные выбросы - точка является выбросом только по одной из своих координат
	- Многомерные выбросы - точка является выбросом сразу по нескольким координатам
- По их окружению:
	- Точечные выбросы - единичные точки, выбивающиеся из общей картины. Точечные аномалии часто используются в системах контроля транзакций для выявления мошенничества, например, когда с украденной карты совершается крупная покупка
	- Контекстуальные выбросы - для того, чтобы определить, является ли точка выбросом, необходим контекст. Например, в Санкт-Петербурге +15°С. Зимой такая температура является выбросом, а летом - нет
	- Коллективные выбросы - здесь выбросом является не точка, а группа точек. Примером таких выбросов могут служить, например, задержки поставок на фабрике. Одна задержка не является выбросом. Но если их много, это может стать проблемой
##### Причины возникновения выбросов
- Сбой работы оборудования
- Человеческий фактор
- Случайность
- Уникальные явления
- и др.
##### Обнаружение выбросов
==Экстремальный анализ данных== - при таком анализе не применяются какие-либо статистические методы. Обычно этот метод применим для одномерного случая.  
Алгоритм использования:  
- Визуализировать данные, используя диаграммы и гистограммы для нахождения экстремальных значений
- Задействовать распределение, например Гауссовское, и найти значения, чье стандартное отклонение отличается в 2-3 раза от математического ожидания или в полтора раза от первой либо третьей квартилей
- Отфильтровать предполагаемые выбросы из обучающей выборки и оценить работу модели
  
![](Excalidraw/07_05.%20Выбросы%20на%20гистограме.png)  