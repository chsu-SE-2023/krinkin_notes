#### Представление 3D объектов

##### Вершины
Точка в пространстве с координатами.

Дополнительные аттрибуты вершин:
	Нормали, текстурные координаты, цвет, веса для скелетной анимации.
##### Грани
Плоская или криволинейная поверхность, ограниченная рёбрами.

Типы граней:
	Треугольники, четырёхугольники, многоугольники с большим числом сторон.
##### Текстурные координаты
Это параметры (u, v), которые определяют как текстура накладывается на поверхность объекта.

Каждая вершина имеет свои текстурные координаты, которые указывают, какая часть текстуры соответствует этой вершине.
При рендеринге текстура интерполируется между вершинами, чтобы покрыть всю грань.
##### Структура 3D-объекта
- Основные компоненты;
- Массив вершин;
- Массив граней;
- Текстурные данные;
- Материалы;

#### Матрицы преобразований в 3D: вращение, масштабирование, перенос
В 3D-графике преобразования точек и объектов выполняются с помощью 4x4 матриц в однородных координатах. Это позволяет объединять все операции в единый математический аппарат, удобный для компьютерной графики.

#### Камеры и видовые преобразования
**Камера** - инструмент, который определяет, как объекты в трёхмерном пространстве проецируются на двухмерную плоскость (экран). Видовые преобразования позволяют управлять положением, ориентацией и полем зрения камеры.
###### Свойства камеры
1. Положение
2. Направление взгляда
3. Вектор "вверх"
4. Поле зрения
5. Соотношение сторон
6. Ближняя и дальняя плоскость отсечения
##### Видовые преобразования
Математические операции, которые переводят объекты из мировой системы координат в систему координат камеры.
##### Этапы
- Мировые координаты -> координаты камеры
- Проецирование (Перевод трёхмерных координат в двумерные для отображения на экране)
- Отсечение (Удаление части объектов, которые находятся за пределами поля зрения камеры)
- Растеризация (Преобразование графических примитивов в пиксели)
##### Матрица вида
Используется для перевода объектов из мировых координат в координаты камеры. Она строится на основе положения камеры, её направления взгляда и вектора "вверх".

Матрица вычисляется следующим образом:
- Вычисляются три базисных вектора:
	- Forward (направление взгляда) f = normalize(look-at - position)
	- Right (правый вектор) r = normalize(f x up)
	- Up (вектор "вверх") u = r x f
$$
\begin{pmatrix}
rx & ry & rz & -r * position \\
uz & uy & uz & -u * position \\
-fz & -fy & -fz & f * position \\
0 & 0 & 0 & 1
\end{pmatrix}
$$
##### Перспективная проекция
Создаёт эффект глубины: объекты, находящиеся дальше от камеры, выглядят меньше.

![[Pasted image 20250328103353.png]]

- FOV - угол поля зрения
- aspect - соотношение сторон экрана
- near и far - ближняя и дальняя плоскости отсечения
##### Ортографическая проекция
Сохраняет размеры объектов не зависимо от их расстояния до камеры.

![[Pasted image 20250328103444.png]]

- Left, right, bottom, top - границы видимой области

#### Удаление невидимых линий и поверхностей (Z-buffer, алгоритм художника)
Это процесс, который позволяет определить, какие части объектов видны с точки зрения камеры, а какие скрыты за другими объектами.
##### Зачем?
В трёхмерной сцене объекты могут перекрывать друг друга. Если все поверхности отрисовываются одновременно, это может привести к визуальным артефактам (например, дальние объекты закрывают ближние). Поэтому необходимо определить какие части объектов видны, а какие скрыты, чтобы создать реалистичное изображение.
##### Z-buffer
Метод, который использует дополнительный массив для хранения глубины (расстояния до камеры) каждого пикселя на экране. При рендеринге сцены каждый пиксель проверяется на предмет того, ближе ли он к камере, чем уже отрисованный пиксель. Если да,  то он заменяет текущий пиксель.
##### Алгоритм художника
Основан на принципе "от дальнего к ближнему". Объекты сортируются по глубине и рендеринг начинается с самых дальних объектов.

Принцип работы
Сортировка объектов:
- Все объекты сортируются по их расстоянию до камеры (от дальнего к ближнему)
Отрисовка объектов:
- Объекты отрисовываются в порядке сортировки. Ближние объекты перекрывают дальние.
##### Другие методы удаления
- Ray tracing (проверка по испускаемым из камеры лучам)
- Binary Space Partitioning (пространства подразделяются на части для определения порядка отрисовки)
- Portal rendering (используется для рендеринга сложных интерьеров с использованием порталов (например дверей))